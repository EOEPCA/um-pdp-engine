<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<meta name="description" content="PDP Engine Design Document for the Common Architecture">
<meta name="keywords" content="common architecture design">
<meta name="author" content="TVUK System Team">
<title>PDP Engine Design Document: EOEPCA.SDD.xxx</title>
<link rel="stylesheet" href="stylesheets/eoepca.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>PDP Engine Design Document: EOEPCA.SDD.xxx</h1>
<div class="details">
<span id="author" class="author">TVUK System Team</span><br>
<span id="email" class="email">&lt;<a href="mailto:Eoepca.SystemTeam@telespazio.com">Eoepca.SystemTeam@telespazio.com</a>&gt;</span><br>
<span id="revnumber">version 0.2,</span>
<span id="revdate">dd/mm/yyyy</span>
<br><span id="revremark"></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">PDP Engine Design Document</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_purpose_and_scope">1.1. Purpose and Scope</a></li>
<li><a href="#_structure_of_the_document">1.2. Structure of the Document</a></li>
<li><a href="#_reference_documents">1.3. Reference Documents</a></li>
<li><a href="#_terminology">1.4. Terminology</a></li>
<li><a href="#_glossary">1.5. Glossary</a></li>
</ul>
</li>
<li><a href="#mainOverview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_building_block_overview">2.1. Building Block Overview</a>
<ul class="sectlevel3">
<li><a href="#_initialization_flow">2.1.1. Initialization flow</a></li>
</ul>
</li>
<li><a href="#_external_interfaces">2.2. External Interfaces</a>
<ul class="sectlevel3">
<li><a href="#_exposed_interfaces">2.2.1. Exposed Interfaces</a>
<ul class="sectlevel4">
<li><a href="#_xacml_fromto_login_service">2.2.1.1. XACML (from/to Login Service)</a></li>
<li><a href="#_policy_api_to_policy_decision_point">2.2.1.2. Policy API (to Policy Decision Point)</a></li>
</ul>
</li>
<li><a href="#_consumed_interfaces">2.2.2. Consumed Interfaces</a>
<ul class="sectlevel4">
<li><a href="#_oidc_to_login_service">2.2.2.1. OIDC (to Login Service)</a></li>
<li><a href="#_scim_to_login_service">2.2.2.2. SCIM (to Login Service)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_internal_interfaces">2.3. Internal Interfaces</a>
<ul class="sectlevel3">
<li><a href="#_back_end_database">2.3.1. Back-End database</a></li>
</ul>
</li>
<li><a href="#_required_resources">2.4. Required resources</a>
<ul class="sectlevel3">
<li><a href="#_software">2.4.1. Software</a></li>
</ul>
</li>
<li><a href="#_static_architecture">2.5. Static Architecture</a></li>
<li><a href="#_use_cases">2.6. Use cases</a>
<ul class="sectlevel3">
<li><a href="#_policy_access_check_use_case">2.6.1. Policy Access Check Use Case</a>
<ul class="sectlevel4">
<li><a href="#_pdp_uc_001_policy_access_check">2.6.1.1. PDP-UC-001: Policy Access Check</a></li>
<li><a href="#_pdp_uc_002_policy_retrieval">2.6.1.2. PDP-UC-002: Policy Retrieval</a></li>
<li><a href="#_pdp_uc_003_get_user_attributes">2.6.1.3. PDP-UC-003: Get User Attributes</a></li>
</ul>
</li>
<li><a href="#_pdp_uc_004_policy_repository_management">2.6.2. PDP-UC-004: Policy Repository Management</a></li>
<li><a href="#_pdp_uc_005_policy_delegation_to_external_pdps">2.6.3. PDP-UC-005: Policy Delegation (to external PDPs)</a></li>
<li><a href="#_pdp_uc_006_policy_decision_point_api">2.6.4. PDP-UC-006: Policy Decision Point API</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#mainDesign">3. Building Block Design</a>
<ul class="sectlevel2">
<li><a href="#_policy_decision_engine">3.1. Policy Decision Engine</a>
<ul class="sectlevel3">
<li><a href="#_overview_and_purpose">3.1.1. Overview and Purpose</a></li>
<li><a href="#_software_reuse_and_dependencies">3.1.2. Software Reuse and Dependencies</a></li>
<li><a href="#_interfaces">3.1.3. Interfaces</a></li>
<li><a href="#_data">3.1.4. Data</a>
<ul class="sectlevel4">
<li><a href="#_configuration">3.1.4.1. Configuration</a></li>
<li><a href="#_data_flow">3.1.4.2. Data flow</a></li>
</ul>
</li>
<li><a href="#_extensibility">3.1.5. Extensibility</a></li>
<li><a href="#_applicable_resources">3.1.6. Applicable Resources</a></li>
</ul>
</li>
<li><a href="#_policy_validation_service">3.2. Policy Validation Service</a>
<ul class="sectlevel3">
<li><a href="#_overview_and_purpose_2">3.2.1. Overview and Purpose</a></li>
</ul>
</li>
<li><a href="#_policy_repository">3.3. Policy Repository</a>
<ul class="sectlevel3">
<li><a href="#_overview_and_purpose_3">3.3.1. Overview and Purpose</a></li>
<li><a href="#_software_reuse_and_dependencies_2">3.3.2. Software Reuse and Dependencies</a></li>
<li><a href="#_data_flow_2">3.3.3. Data flow</a></li>
<li><a href="#_applicable_resources_2">3.3.4. Applicable Resources</a></li>
</ul>
</li>
<li><a href="#_logging">3.4. Logging</a>
<ul class="sectlevel3">
<li><a href="#_design">3.4.1. Design</a></li>
<li><a href="#_log_message_format">3.4.2. Log message format</a></li>
<li><a href="#_log_message_codes">3.4.3. Log message codes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#traceabilityMatrix">4. User Story Traceability</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>EO Exploitation Platform Common Architecture<br>
<em>PDP Engine Design Document</em><br>
EOEPCA.SDD.xxx</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>COMMENTS and ISSUES</strong><br>
If you would like to raise comments or issues on this document, please do so by raising an Issue at the following URL <a href="https://github.com/EOEPCA/um-pdp-engine/issues" class="bare">https://github.com/EOEPCA/um-pdp-engine/issues</a>.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>PDF</strong><br>
This document is available in PDF format <a href="EOEPCA-um-pdp-engine.pdf" target="_blank" rel="noopener">here</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>EUROPEAN SPACE AGENCY CONTRACT REPORT</strong><br>
The work described in this report was done under ESA contract. Responsibility for the contents resides in the author or organisation that prepared it.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>TELESPAZIO VEGA UK Ltd</strong><br>
350 Capability Green, Luton, Bedfordshire, LU1 3LU, United Kingdom.<br>
Tel: +44 (0)1582 399000<br>
<a href="http://telespazio-vega.com/">www.telespazio-vega.com</a></p></td>
</tr>
</tbody>
</table>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">AMENDMENT HISTORY</dt>
<dd>
<p>This document shall be amended by releasing a new edition of the document in its entirety.<br>
The Amendment Record Sheet below records the history and issue status of this document.</p>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Amendment Record Sheet</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 25%;">
<col style="width: 62.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">ISSUE</th>
<th class="tableblock halign-center valign-top">DATE</th>
<th class="tableblock halign-left valign-top">REASON</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">0.1</p></th>
<td class="tableblock halign-center valign-top"><p class="tableblock">dd/mm/yyyy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial in-progress draft</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<hr>
<div style="page-break-after: always;"></div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose_and_scope">1.1. Purpose and Scope</h3>
<div class="paragraph">
<p>This document presents the PDP Engine Design for the Common Architecture.</p>
</div>
</div>
<div class="sect2">
<h3 id="_structure_of_the_document">1.2. Structure of the Document</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Section 2 - <a href="#mainOverview">Overview</a></dt>
<dd>
<p>Provides an over of the PDP Engine component, within the context of the wider Common Architecture design.</p>
</dd>
<dt class="hdlist1">Section 3 - <a href="#mainDesign">Building Block Design</a></dt>
<dd>
<p>Provides the design of the PDP Engine component.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_reference_documents">1.3. Reference Documents</h3>
<div class="paragraph">
<p>The following is a list of Reference Documents with a direct bearing on the content of this document.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 63.6363%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Reference</th>
<th class="tableblock halign-left valign-top">Document Details</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="EOEPCA-UC"></a>[EOEPCA-UC]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>EOEPCA - Use Case Analysis<br>
EOEPCA.TN.005<br>
<a href="https://eoepca.github.io/use-case-analysis" class="bare">https://eoepca.github.io/use-case-analysis</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Issue 1.0,<br>
02/08/2019</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="EP-FM"></a>[EP-FM]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Exploitation Platform - Functional Model,<br>
ESA-EOPSDP-TN-17-050</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Issue 1.0,<br>
30/11/2017</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TEP-OA"></a>[TEP-OA]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Thematic Exploitation Platform Open Architecture,<br>
EMSS-EOPS-TN-17-002</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Issue 1,<br>
12/12/2017</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="WPS-T"></a>[WPS-T]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-14: WPS-T Engineering Report,<br>
OGC 18-036r1,<br>
<a href="http://docs.opengeospatial.org/per/18-036r1.html" class="bare">http://docs.opengeospatial.org/per/18-036r1.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>18-036r1,<br>
07/02/2019</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="WPS-REST-JSON"></a>[WPS-REST-JSON]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC WPS 2.0 REST/JSON Binding Extension, Draft,<br>
OGC 18-062,<br>
<a href="https://raw.githubusercontent.com/opengeospatial/wps-rest-binding/develop/docs/18-062.pdf" class="bare">https://raw.githubusercontent.com/opengeospatial/wps-rest-binding/develop/docs/18-062.pdf</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>1.0-draft</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="CWL"></a>[CWL]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Common Workflow Language Specifications,<br>
<a href="https://www.commonwl.org/v1.0/" class="bare">https://www.commonwl.org/v1.0/</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.0.2</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TB13-AP"></a>[TB13-AP]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-13, EP Application Package Engineering Report,<br>
OGC 17-023,<br>
<a href="http://docs.opengeospatial.org/per/17-023.html" class="bare">http://docs.opengeospatial.org/per/17-023.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>17-023,<br>
30/01/2018</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TB13-ADES"></a>[TB13-ADES]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-13, Application Deployment and Execution Service Engineering Report,<br>
OGC 17-024,<br>
<a href="http://docs.opengeospatial.org/per/17-024.html" class="bare">http://docs.opengeospatial.org/per/17-024.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>17-024,<br>
11/01/2018</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TB14-AP"></a>[TB14-AP]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-14, Application Package Engineering Report,<br>
OGC 18-049r1,<br>
<a href="http://docs.opengeospatial.org/per/18-049r1.html" class="bare">http://docs.opengeospatial.org/per/18-049r1.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>18-049r1,<br>
07/02/2019</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TB14-ADES"></a>[TB14-ADES]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-14, ADES &amp; EMS Results and Best Practices Engineering Report,<br>
OGC 18-050r1, <a href="http://docs.opengeospatial.org/per/18-050r1.html" class="bare">http://docs.opengeospatial.org/per/18-050r1.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>18-050r1,<br>
08/02/2019</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OS-GEO-TIME"></a>[OS-GEO-TIME]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OpenSearch GEO: OpenSearch Geo and Time Extensions,<br>
OGC 10-032r8,<br>
<a href="http://www.opengeospatial.org/standards/opensearchgeo" class="bare">http://www.opengeospatial.org/standards/opensearchgeo</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>10-032r8,<br>
14/04/2014</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OS-EO"></a>[OS-EO]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OpenSearch EO: OGC OpenSearch Extension for Earth Observation,<br>
OGC 13-026r9,<br>
<a href="http://docs.opengeospatial.org/is/13-026r8/13-026r8.html" class="bare">http://docs.opengeospatial.org/is/13-026r8/13-026r8.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>13-026r9,<br>
16/12/2016</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="GEOJSON-LD"></a>[GEOJSON-LD]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC EO Dataset Metadata GeoJSON(-LD) Encoding Standard,<br>
OGC 17-003r1/17-084</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>17-003r1/17-084</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="GEOJSON-LD-RESP"></a>[GEOJSON-LD-RESP]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC OpenSearch-EO GeoJSON(-LD) Response Encoding Standard,<br>
OGC 17-047</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>17-047</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="PCI-DSS"></a>[PCI-DSS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The Payment Card Industry Data Security Standard,<br>
<a href="https://www.pcisecuritystandards.org/document_library?category=pcidss&amp;document=pci_dss" class="bare">https://www.pcisecuritystandards.org/document_library?category=pcidss&amp;document=pci_dss</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v3.2.1</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="CEOS-OS-BP"></a>[CEOS-OS-BP]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>CEOS OpenSearch Best Practise,<br>
<a href="http://ceos.org/ourwork/workinggroups/wgiss/access/opensearch/" class="bare">http://ceos.org/ourwork/workinggroups/wgiss/access/opensearch/</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.2,<br>
13/06/2017</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OIDC"></a>[OIDC]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OpenID Connect Core 1.0,<br>
<a href="https://openid.net/specs/openid-connect-core-1_0.html" class="bare">https://openid.net/specs/openid-connect-core-1_0.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.0,<br>
08/11/2014</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-CSW"></a>[OGC-CSW]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Catalogue Services 3.0 Specification - HTTP Protocol Binding (Catalogue Services for the Web),<br>
OGC 12-176r7,<br>
<a href="http://docs.opengeospatial.org/is/12-176r7/12-176r7.html" class="bare">http://docs.opengeospatial.org/is/12-176r7/12-176r7.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v3.0,<br>
10/06/2016</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WMS"></a>[OGC-WMS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Web Map Server Implementation Specification,<br>
OGC 06-042,<br>
<a href="http://portal.opengeospatial.org/files/?artifact_id=14416" class="bare">http://portal.opengeospatial.org/files/?artifact_id=14416</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.3.0,<br>
05/03/2006</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WMTS"></a>[OGC-WMTS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Web Map Tile Service Implementation Standard,<br>
OGC 07-057r7,<br>
<a href="http://portal.opengeospatial.org/files/?artifact_id=35326" class="bare">http://portal.opengeospatial.org/files/?artifact_id=35326</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.0.0,<br>
06/04/2010</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WFS"></a>[OGC-WFS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Web Feature Service 2.0 Interface Standard – With Corrigendum,<br>
OGC 09-025r2,<br>
<a href="http://docs.opengeospatial.org/is/09-025r2/09-025r2.html" class="bare">http://docs.opengeospatial.org/is/09-025r2/09-025r2.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v2.0.2,<br>
10/07/2014</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WCS"></a>[OGC-WCS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Web Coverage Service (WCS) 2.1 Interface Standard - Core,<br>
OGC 17-089r1,<br>
<a href="http://docs.opengeospatial.org/is/17-089r1/17-089r1.html" class="bare">http://docs.opengeospatial.org/is/17-089r1/17-089r1.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v2.1,<br>
16/08/2018</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WCPS"></a>[OGC-WCPS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Web Coverage Processing Service (WCPS) Language Interface Standard,<br>
OGC 08-068r2,<br>
<a href="http://portal.opengeospatial.org/files/?artifact_id=32319" class="bare">http://portal.opengeospatial.org/files/?artifact_id=32319</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.0.0,<br>
25/03/2009</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="AWS-S3"></a>[AWS-S3]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Amazon Simple Storage Service REST API,<br>
<a href="https://docs.aws.amazon.com/AmazonS3/latest/API" class="bare">https://docs.aws.amazon.com/AmazonS3/latest/API</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>API Version 2006-03-01</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_terminology">1.4. Terminology</h3>
<div class="paragraph">
<p>The following terms are used in the Master System Design.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User with administrative capability on the EP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A self-contained set of operations to be performed, typically to achieve a desired data manipulation. The algorithm must be implemented (codified) for deployment and execution on the platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Analysis Result</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Products</em> produced as output of an <em>Interactive Application</em> analysis session.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Analytics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A set of activities aimed to discover, interpret and communicate meaningful patters within the data. Analytics considered here are performed manually (or in a semi-automatic way) on-line with the aid of <em>Interactive Applications</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Artefact</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The 'software' component that provides the execution unit of the <em>Application Package</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Deployment and Execution Service (ADES)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WPS-T (REST/JSON) service that incorporates the Docker execution engine, and is responsible for the execution of the processing service (as a WPS request) within the ‘target’ Exploitation Platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Descriptor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A file that provides the metadata part of the <em>Application Package</em>. Provides all the metadata required to accommodate the processor within the WPS service and make it available for execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Package</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A platform independent and self-contained representation of a software item, providing executable, metadata and dependencies such that it can be deployed to and executed within an Exploitation Platform. Comprises the <em>Application Descriptor</em> and the <em>Application Artefact</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bulk Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution of a <em>Processing Service</em> on large amounts of data specified by AOI and TOI.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The codification of an algorithm performed with a given programming language - compiled to Software or directly executed (interpretted) within the platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute Platform</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Platform on which execution occurs (this may differ from the Host or Home platform where federated processing is happening)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consumer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User accessing existing services/products within the EP. Consumers may be scientific/research or commercial, and may or may not be experts of the domain</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Access Library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An abstraction of the interface to the data layer of the resource tier. The library provides bindings for common languages (including python, Javascript) and presents a common object model to the code.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The act of building new products/services/applications to be exposed within the platform and made available for users to conduct exploitation activities. Development may be performed inside or outside of the platform. If performed outside, an integration activity will be required to accommodate the developed service so that it is exposed within the platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Discovery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User finds products/services of interest to them based upon search criteria.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The act to start a <em>Processing Service</em> or an <em>Interactive Application</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution Management Service (EMS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The EMS is responsible for the orchestration of workflows, including the possibility of steps running on other (remote) platforms, and the on-demand deployment of processors to local/remote ADES as required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User developing and integrating added-value to the EP (Scientific Researcher or Service Developer)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation Tier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Exploitation Tier represents the end-users who exploit the services of the platform to perform analysis, or using high-level applications built-in on top of the platform’s services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">External Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An application or script that is developed and executed outside of the Exploitation Platform, but is able to use the data/services of the EP via a programmatic interface (API).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An unregistered User or an unauthenticated Consumer with limited access to the EP&#8217;s services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Home Platform</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Platform on which a User is based or from which an action was initiated by a User</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host Platform</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Platform through which a Resource has been published</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity Provider (IdP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The source for validating user identity in a federated identity system, (user authentication as a service).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interactive Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A stand-alone application provided within the exploitation platform for on-line hosted processing. Provides an interactive interface through which the user is able to conduct their analysis of the data, producing <em>Analysis Results</em> as output. Interactive Applications include at least the following types: console application, web application (rich browser interface), remote desktop to a hosted VM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interactive Console Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A simple <em>Interactive Application</em> for analysis in which a console interface to a platform-hosted terminal is provided to the user. The console interface can be provided through the user&#8217;s browser session or through a remote SSH connection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interactive Remote Desktop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An Interactive Application for analysis provided as a remote desktop session to an OS-session (or directly to a 'native' application) on the exploitation platform. The user will have access to a number of applications within the hosted OS. The remote desktop session is provided through the user’s web browser.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interactive Web Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An Interactive Application for analysis provided as a rich user interface through the user&#8217;s web browser.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key-Value Pair</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A key-value pair (KVP) is an abstract data type that includes a group of key identifiers and a set of associated values. Key-value pairs are frequently used in lookup tables, hash tables and configuration files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes (K8s)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container orchestration system for automating application deployment, scaling and management.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An encapsulation of Authenticated Login provision within the Exploitation Platform context. The Login Service is an OpenID Connect Provider that is used purely for authentication. It acts as a Relying Party in flows with external IdPs to obtain access to the user&#8217;s identity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EO Network of Resources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The coordinated collection of European EO resources (platforms, data sources, etc.).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object Store</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A computer data storage architecture that manages data as objects. Each object typically includes the data itself, a variable amount of metadata, and a globally unique identifier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-demand Processing Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <em>Processing Service</em> whose execution is initiated directly by the user on an ad-hoc basis.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform (EP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An on-line collection of products, services and tools for exploitation of EO data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform Tier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Platform Tier represents the Exploitation Platform and the services it offers to end-users</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A set of pre-defined activities that interact to achieve a result. For the exploitation platform, comprises on-line processing to derive data products from input data, conducted by a hosted processing service execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing Result</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Products</em> produced as output of a <em>Processing Service</em> execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A non-interactive data processing that has a well-defined set of input data types, input parameterisation, producing <em>Processing Results</em> with a well-defined output data type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Products</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EO data (commercial and non-commercial) and Value-added products and made available through the EP. <em>It is assumed that the Hosting Environment for the EP makes available an existing supply of EO Data</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A entity, such as a Product, Processing Service or Interactive Application, which is of interest to a user, is indexed in a catalogue and can be returned as a single meaningful search result</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource Tier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Resource Tier represents the hosting infrastructure and provides the EO data, storage and compute upon which the exploitation platform is deployed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reusable Research Object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An encapsulation of some research/analysis that describes all aspects required to reproduce the analysis, including data used, processing performed etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scientific Researcher</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expert user with the objective to perform scientific research. Having minimal IT knowledge with no desire to acquire it, they want the effort for the translation of their algorithm into a service/product to be minimised by the platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service Developer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expert user with the objective to provide a performing, stable and reliable service/product. Having deeper IT knowledge or a willingness to acquire it, they require deeper access to the platform IT functionalities for optimisation of their algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Software</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The compilation of code into a binary program to be executed within the platform on-line computing environment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Systematic Processing Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <em>Processing Service</em> whose execution is initiated automatically (on behalf of a user), either according to a schedule (routine) or triggered by an event (e.g. arrival of new data).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terms &amp; Conditions (T&amp;Cs)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The obligations that the user agrees to abide by in regard of usage of products/services of the platform. T&amp;Cs are set by the provider of each product/service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactional Web Processing Service (WPS-T)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactional extension to WPS that allows adhoc deployment / undeployment of user-provided processors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An individual using the EP, of any type (Admin/Consumer/Expert/Guest)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value-added products</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Products generated from processing services of the EP (or external processing) and made available through the EP. This includes products uploaded to the EP by users and published for collaborative consumption</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Visualisation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To obtain a visual representation of any data/products held within the platform - presented to the user within their web browser session.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Coverage Service (WCS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that provides an open specification for sharing raster datasets on the web.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Coverage Processing Service (WCPS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that defines a protocol-independent language for the extraction, processing, and analysis of multi-dimentional coverages representing sensor, image, or statistics data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Feature Service (WFS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that makes geographic feature data (vector geospatial datasets) available on the web.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Map Service (WMS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that provides a simple HTTP interface for requesting geo-registered map images from one or more distributed geospatial databases.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Map Tile Service (WMTS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that provides a simple HTTP interface for requesting map tiles of spatially referenced data using the images with predefined content, extent, and resolution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Processing Services (WPS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that defines how a client can request the execution of a process, and how the output from the process is handled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workspace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user-scoped 'container' in the EP, in which each user maintains their own links to resources (products and services) that have been collected by a user during their usage of the EP. The workspace acts as the hub for a user&#8217;s exploitation activities within the EP</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_glossary">1.5. Glossary</h3>
<div class="paragraph">
<p>The following acronyms and abbreviations have been used in this report.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 85.7143%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AAI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication &amp; Authorization Infrastructure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ABAC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute Based Access Control</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Deployment and Execution Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALFA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abbreviated Language For Authorization</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AOI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Area of Interest</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Programming Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Management System</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CWL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Workflow Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Access Library</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution Management Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Earth Observation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation Platform</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FUSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filesystem in Userspace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GeoXACML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Geo-specific extension to the XACML Policy Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity and Access Management</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IdP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity Provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaScript Object Notation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K8s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KVP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key-value Pair</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M2M</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine-to-machine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Geospatial Consortium</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processor Development Environment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Decision Point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PEP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Enforcement Point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Information Point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RBAC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Role Based Access Control</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Representational State Transfer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Shell</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time of Interest</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UMA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User-Managed Access</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VNC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual Network Computing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Coverage Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Coverage Processing Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WFS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Feature Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Map Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WMTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Map Tile Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Processing Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WPS-T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactional Web Processing Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XACML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eXtensible Access Control Markup Language</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mainOverview">2. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_building_block_overview">2.1. Building Block Overview</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>High-Level Description of the Building Block</p>
</li>
<li>
<p>Context within EOEPCA</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main functionality of the PDP is to be able to perform complex Policy Decisions based on Policy Documents. In order to do so, several functionality blocks are identified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Policy Check Endpoint. A XACML-compliant endpoint that allows to submit JSON XACML requests and receive the corresponding responses.</p>
<div class="ulist">
<ul>
<li>
<p>SCIM Client, allowing to retrieve user information that is local to the platform, whenever possible.</p>
</li>
<li>
<p>OIDC Client, allowing to authenticate the component as trusted within the architecture.</p>
</li>
<li>
<p>Resource API Client, allowing to retrieve details about the resources being accessed.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Policy Repository Management. An exposed API allowing to register and/or query policies assigned to specific resources.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_initialization_flow">2.1.1. Initialization flow</h4>
<div class="paragraph">
<p>The figure below, identifies the main workflows on which the PDP Engine participates, along with it&#8217;s components:</p>
</div>
<div class="imageblock text-right">
<div class="content">
<img src="./images/pdp_flow.png" alt="pdp flow">
</div>
</div>
<div class="paragraph">
<p>When launched, the PDP will answer to all requests to 2 specific paths:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Policy Management (/policy/ and /policy/&lt;policy_id or ObjectId(policy_id)&gt;): To perform operations like GET/UPDATE/DELETE policies</p>
</li>
<li>
<p>Policy Access Check (/policy/validate): to check the policy access to a resource using a xacml from the request<br>
The requests should be accompained by an "Authorization: Bearer &lt;valid_RPT&gt;" for all endpoints except for the de /validate</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Examples, given the example values of:<br>
- path configured: "/pdp"<br>
- PDP is at pdp.domain.com/policy<br>
- For Validate policies: "/policy/validate"</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Token</th>
<th class="tableblock halign-left valign-top">Request to PDP</th>
<th class="tableblock halign-left valign-top">PDP Action</th>
<th class="tableblock halign-left valign-top">PDP answer</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No RPT/OAuth token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pdp.domain.com</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None (request does not get to PDP endpoint)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None (the PDP doesn&#8217;t see this request)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No RPT/OAuth token and Valid data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pdp.domain.com/policy/validate with a json as data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validates the policy access related to the json request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return a response with Permit access</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No RPT/OAuth token and Not valid data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pdp.domain.com/policy/validate with a json as data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validates the policy access related to the json request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return a response with Deny access</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPT/OAuth token + Policy information as data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pdp.domain.com/policy/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register Policy in the Back-end Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy_id for the policy just created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No RPT/OAuth token + Policy information as data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pdp.domain.com/policy/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register Policy in Back-end Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">401</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPT/OAuth token + Policy information as data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pdp.domain.com/policy/&lt;policy_id or ObjectId(policy_id)&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs the operations of Get/Update/Delete policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get: Return the policy Update: "updated" or "no changes made"  Delete: 204 if exists</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No RPT/OAuth token + Policy information as data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pdp.domain.com/policy/&lt;policy_id or ObjectId(policy_id)&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs the operations of Get/Update/Delete policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">401</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_external_interfaces">2.2. External Interfaces</h3>
<div class="sect3">
<h4 id="_exposed_interfaces">2.2.1. Exposed Interfaces</h4>
<div class="sect4">
<h5 id="_xacml_fromto_login_service">2.2.1.1. XACML (from/to Login Service)</h5>
<div class="paragraph">
<p>The PDP exposes a policy check endpoint compliant with XACML 3.0 standards (<a href="http://docs.oasis-open.org/xacml/3.0/xacml-3.0-core-spec-en.html" class="bare">http://docs.oasis-open.org/xacml/3.0/xacml-3.0-core-spec-en.html</a>), whith a content-type application/json due to its JSON Profile.</p>
</div>
<div class="paragraph">
<p>For the function of parse XACML requests to get a decision about the access to a policy, you can use <code>/policy/validate</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_policy_api_to_policy_decision_point">2.2.1.2. Policy API (to Policy Decision Point)</h5>
<div class="paragraph">
<p>The PDP queries the corresponding PDP to retrieve information about a policy.<br>
For this case we can use the <code>/policy/&lt;policy_id or ObjectId(policy_id)&gt;</code> to do all the operations related to insert, get, update and delete policies.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_consumed_interfaces">2.2.2. Consumed Interfaces</h4>
<div class="sect4">
<h5 id="_oidc_to_login_service">2.2.2.1. OIDC (to Login Service)</h5>
<div class="paragraph">
<p>The PDP uses the OIDC protocol in order to authenticate itself as a valid UMA client, and uses this OIDC client in all UMA-related queries.It allows Clients to verify the identity of the End-User. (<a href="https://gluu.org/docs/gluu-server/4.0/admin-guide/openid-connect/" class="bare">https://gluu.org/docs/gluu-server/4.0/admin-guide/openid-connect/</a>)</p>
</div>
<div class="paragraph">
<p>These queries are done against the Login Service, and the endpoints used are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Discovery Endpoint: /.well-known/openid-configuration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And the keys used from Well Known Handler:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Token Endpoint: KEY_OIDC_TOKEN_ENDPOINT</p>
</li>
<li>
<p>UserInfo Endpoint: KEY_OIDC_USERINFO_ENDPOINT</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_scim_to_login_service">2.2.2.2. SCIM (to Login Service)</h5>
<div class="paragraph">
<p>The PDP has the capability to auto-register itself as a client if there is no client pre-configured from previous starts or previous configuration. In order to do this, it utilizes the SCIM protocol which is designed to reduce the complexity of user management operations. (<a href="https://gluu.org/docs/gluu-server/3.1.1/user-management/scim2/" class="bare">https://gluu.org/docs/gluu-server/3.1.1/user-management/scim2/</a>)</p>
</div>
<div class="paragraph">
<p>The keys used from Well Known Handler:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User Atributes: KEY_SCIM_USER_ENDPOINT</p>
</li>
<li>
<p>Private Key JWT Key: ENDPOINT_AUTH_CLIENT_PRIVATE_KEY_JWT</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_internal_interfaces">2.3. Internal Interfaces</h3>
<div class="sect3">
<h4 id="_back_end_database">2.3.1. Back-End database</h4>
<div class="paragraph">
<p>In order to access the policies, these policies will be stored in a non-relational database. In which will be stored document-oriented information such as JSON-like documents with optional schemas.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_required_resources">2.4. Required resources</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>List of HW and SW required resources for the correct functioning of the building Block</p>
</li>
<li>
<p>References to open repositories (when applicable)</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_software">2.4.1. Software</h4>
<div class="paragraph">
<p>The following Open-Source Software is required to support the deployment and integration of the Policy Enforcement Point:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EOEPCA&#8217;s SCIM Client - <a href="https://github.com/EOEPCA/um-common-scim-client" class="bare">https://github.com/EOEPCA/um-common-scim-client</a></p>
</li>
<li>
<p>EOEPCA&#8217;s OpenID - <a href="https://github.com/EOEPCA/um-common-oidc-client" class="bare">https://github.com/EOEPCA/um-common-oidc-client</a></p>
</li>
<li>
<p>EOEPCA&#8217;s Well Known Handler - <a href="https://github.com/EOEPCA/well-known-handler" class="bare">https://github.com/EOEPCA/well-known-handler</a></p>
</li>
<li>
<p>Flask - <a href="https://github.com/pallets/flask" class="bare">https://github.com/pallets/flask</a></p>
</li>
<li>
<p>MongoDB for python - <a href="https://pymongo.readthedocs.io/en/stable/index.html" class="bare">https://pymongo.readthedocs.io/en/stable/index.html</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_static_architecture">2.5. Static Architecture</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Diagram and description of the major logical components within the Building Block</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With the diagram below, you can see how the connection between the back-end database and the pdp-engine:</p>
</div>
<div class="imageblock text-right">
<div class="content">
<img src="./images/pdp_flow.png" alt="pdp flow">
</div>
</div>
<div class="paragraph">
<p>The PDP is composed of two main components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The PDP Engine (related to the endpoint that are exposed): This component will expose the endpoints that we commented before. For this it will be necessary to establish a client for SCIM and another for OIDC.</p>
</li>
<li>
<p>And a Back-end Database: This component store all information related to policies and will interact within the endpoints.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">The next section <a href="#mainDesign">Building Block Design</a></dt>
<dd>
<p>contains detailed descriptions and references needed to understand the intricacies of this component.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_use_cases">2.6. Use cases</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Diagrams and definition of the use cases covered by this Building Block</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_policy_access_check_use_case">2.6.1. Policy Access Check Use Case</h4>
<div class="imageblock text-center">
<div class="content">
<img src="./images/use_case.png" alt="use case">
</div>
</div>
<div class="paragraph">
<p>This diagram covers the following use cases:</p>
</div>
<div class="sect4">
<h5 id="_pdp_uc_001_policy_access_check">2.6.1.1. PDP-UC-001: Policy Access Check</h5>
<div class="paragraph">
<p>When the PDP has obtained the policies, we proceed to compare the content of these policies with the values obtained from the request using the ScimHandler, mainly they are the resource id, action type, and the user_name, in case that some of these do not coincide, it will be response with "Deny" in the json or with a "Permit" if everything is correct.</p>
</div>
</div>
<div class="sect4">
<h5 id="_pdp_uc_002_policy_retrieval">2.6.1.2. PDP-UC-002: Policy Retrieval</h5>
<div class="paragraph">
<p>The PDP access through the resource id that was extracted from the XACML in the request and using the Policy_Storage class, allows to access the Back-end databse and extracts all the policies information stored for that resource id.</p>
</div>
</div>
<div class="sect4">
<h5 id="_pdp_uc_003_get_user_attributes">2.6.1.3. PDP-UC-003: Get User Attributes</h5>
<div class="paragraph">
<p>SCIM will be used in order to obtain the attributes for the user that have been extracted from the XACML of the request and then use them in the PDP functions. The issuer variable of the XACML subject-id field can be optionally used to determine the SCIM Endpoint on which the PDP will attempt to perform attribute release. If this value is not available, it will be extracted from configuration or environment variables.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pdp_uc_004_policy_repository_management">2.6.2. PDP-UC-004: Policy Repository Management</h4>
<div class="paragraph">
<p>The PDP allows for calls done on specific API endpoints for policy management. The currently available options are:<br>
* Register policy<br>
* Get policy (based on policy ID)<br>
* Get all available policies (based on ownership id)<br>
* Modify policy<br>
* Delete policy</p>
</div>
</div>
<div class="sect3">
<h4 id="_pdp_uc_005_policy_delegation_to_external_pdps">2.6.3. PDP-UC-005: Policy Delegation (to external PDPs)</h4>
<div class="paragraph">
<p>Whenever a policy rule has a <strong>delegate</strong> parameter with a reference URI to an external PDP, the current PDP will forward the xacml request to the external PDP referencing itself in it. The external PDP will validate the remaining policies (that were referenced with the <strong>delegate</strong> parameter). If the external PDP has the policy, it will return a permission granted on its side. If all the policy checks are positively validated (current PDP and foreign PDP(s)), the permission is granted. If otherwise any policy check fails to validate, the permission is denied.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/PDPEndpoints.png" alt="PDPEndpoints">
</div>
</div>
<div class="paragraph">
<p>This diagram covers the following use cases:</p>
</div>
</div>
<div class="sect3">
<h4 id="_pdp_uc_006_policy_decision_point_api">2.6.4. PDP-UC-006: Policy Decision Point API</h4>
<div class="paragraph">
<p>The current implemented functionalities can be consulted through a specific OpenAPI webpage, available at the PDP level.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mainDesign">3. Building Block Design</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A concise breakdown of the Building Block in several independent services (when applicable). For each component, the following subsections are added:</p>
<div class="ulist">
<ul>
<li>
<p>Overview and purpose: indicating the functionality covered by the component</p>
</li>
<li>
<p>SW Reuse and Dependencies: indicating reuse of third party open source solutions (if any) and any pre-required Dependencies</p>
</li>
<li>
<p>Interfaces: both internal to the building block and those exposed externally</p>
</li>
<li>
<p>Data: Data usage of the building block, data flow and any GDPR concerns should be addressed here</p>
</li>
<li>
<p>Applicable Resources: links and references to (Reference Docs), and repositories.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a breakdown is necessary, a general overview of the building block can be given. On the contrary, no breakdown indicates a single component development with the same expected sections.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_policy_decision_engine">3.1. Policy Decision Engine</h3>
<div class="sect3">
<h4 id="_overview_and_purpose">3.1.1. Overview and Purpose</h4>
<div class="paragraph">
<p>The Flask-based endpoint allows to query and retrieve XACML-compliant requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="_software_reuse_and_dependencies">3.1.2. Software Reuse and Dependencies</h4>
<div class="paragraph">
<p>All requirements for the executing of the reverse proxy are found under src/requirements.txt, and expect Python 3.6.9 or greater to work.</p>
</div>
<div class="paragraph">
<p>The most important are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>EOEPCA-SCIM</strong>: Used as a complementary measure to the XACML passing of client assertions.</p>
</li>
<li>
<p><strong>EOEPCA-OIDC</strong>: Used to auto-register itself as a client to the Auth. Server upon start-up.</p>
</li>
<li>
<p><strong>WellKnownHandler</strong>: Used to dynamically check the configuration of the Authorization Server on each execution. For example, it can get the needed endpoints for any API the PDP needs, such as the token request for OIDC.</p>
</li>
<li>
<p><strong>Flask</strong>: External to EOEPCA&#8217;s project, this library allows the PDP to expose its endpoints.</p>
</li>
<li>
<p><strong>MongoDB</strong>: Used to storage the policies for every resource, with the possibility of performing actions such as insert policies, modify, delete, etc</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_interfaces">3.1.3. Interfaces</h4>
<div class="paragraph">
<p>This component doesn&#8217;t have any internal interfaces. For a reference of external interfaces see <a href="#_external_interfaces">External Interfaces</a> on Section 2 <a href="#mainOverview">Overview</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_data">3.1.4. Data</h4>
<div class="sect4">
<h5 id="_configuration">3.1.4.1. Configuration</h5>
<div class="paragraph">
<p>The PDP gets all its configuration from the file located under config/config.json.</p>
</div>
<div class="paragraph">
<p>The parameters that are accepted, and their meaning, are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>prefix</strong>: "/path"-formatted string to indicate where the reverse proxy should listen. Default is "/pdp"</p>
</li>
<li>
<p><strong>host</strong>: Host for the proxy to listen on. For example, "0.0.0.0" will listen on all interfaces</p>
</li>
<li>
<p><strong>port</strong>: Port for the proxy to listen on. By default, 5567. Keep in mind you will have to edit the docker file and/or kubernetes yaml file in order for all the prot forwarding to work.</p>
</li>
<li>
<p><strong>check_ssl_certs</strong>: Toggle on/off (bool) to check certificates in all requests. This should be forced to True in a production environment</p>
</li>
<li>
<p><strong>debug_mode</strong>: Toggle on/off (bool) a debug mode of Flask. In a production environment, this should be false.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_data_flow">3.1.4.2. Data flow</h5>
<div class="paragraph">
<p>The only information the PDP handles are XACML json format from the request, and policies provided by a Back-End database.</p>
</div>
<div class="paragraph">
<p>What follows is an example of the nominal flow for the PDP:</p>
</div>
<div class="imageblock text-right">
<div class="content">
<img src="./images/Use_Case_PDP_final.png" alt="Use Case PDP final">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_extensibility">3.1.5. Extensibility</h4>
<div class="paragraph">
<p>The design of the PDP allows for further improvements if need be. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The proxy can be expanded to parse further parameters on top of the HTTP protocol, allowing for any kind of plugin or complex mechanism desired.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_applicable_resources">3.1.6. Applicable Resources</h4>
<div class="ulist">
<ul>
<li>
<p>XACML 3.0 JSON Profile Specification 1.1 - <a href="http://docs.oasis-open.org/xacml/xacml-json-http/v1.1/xacml-json-http-v1.1.html" class="bare">http://docs.oasis-open.org/xacml/xacml-json-http/v1.1/xacml-json-http-v1.1.html</a></p>
</li>
<li>
<p>EOEPCA&#8217;s SCIM Client - <a href="https://github.com/EOEPCA/um-common-scim-client" class="bare">https://github.com/EOEPCA/um-common-scim-client</a></p>
</li>
<li>
<p>EOEPCA&#8217;s OIDC Client - <a href="https://github.com/EOEPCA/um-common-uma-client" class="bare">https://github.com/EOEPCA/um-common-uma-client</a></p>
</li>
<li>
<p>EOEPCA&#8217;s Well Known Handler - <a href="https://github.com/EOEPCA/well-known-handler" class="bare">https://github.com/EOEPCA/well-known-handler</a></p>
</li>
<li>
<p>Flask - <a href="https://github.com/pallets/flask" class="bare">https://github.com/pallets/flask</a></p>
</li>
<li>
<p>Policy Language - <a href="https://app.swaggerhub.com/apis/hector-rodriguez/PolicyAPI/1-oas3" class="bare">https://app.swaggerhub.com/apis/hector-rodriguez/PolicyAPI/1-oas3</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_policy_validation_service">3.2. Policy Validation Service</h3>
<div class="sect3">
<h4 id="_overview_and_purpose_2">3.2.1. Overview and Purpose</h4>
<div class="paragraph">
<p>The functionality is to validate that the policy is fulfilled with the request received at the /validate endpoint, and return a response with the access or denied access.<br>
For this purpose, the following points are considered:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Validates the policy conditions (AND, OR, XOR, NOT) and returns True or False</p>
</li>
<li>
<p>Validate the value received in the request with the policy values together with the condition (LESS, LESSEQUAL, GREATER, GREATEREQUAL, EQUAL) and return True or False</p>
</li>
<li>
<p>Split the policy rule in order to obtain the value for each condition</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_policy_repository">3.3. Policy Repository</h3>
<div class="sect3">
<h4 id="_overview_and_purpose_3">3.3.1. Overview and Purpose</h4>
<div class="paragraph">
<p>It is the database based on MongoDB where the policies are stored and queried for the PDP pourposes</p>
</div>
<div class="paragraph">
<p>Included with the PDP there is a script at the source path that performs queries against a Mongo Database. The main purpose of this script is to reduce the usage of RAM when registering a policy locally and when querying for its content.<br>
It is developed to generate a database called 'policy_db' in case it does not exist. The collection used for the storage of the documents is called 'policies'.<br>
The main functionalities are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Insert policy</strong>: Will generate a document with the policy data recived as input if it alredy exists it will update it. The main parameters of the policy would be an auto-generated id provided by mongo which identify each document in the database, the resource_id provided by the login-service, the name for the policy, and the configuratino which will be the policy with its resource_id. This would be mandatory parameters in order to perform other kind of queries.</p>
</li>
<li>
<p><strong>Update policy</strong>: Updates the content of a policy stored matched by its ID</p>
</li>
<li>
<p><strong>Get policy from resource id</strong>: Finds the policy, attached to a resource by a resource_id given. Returns a list of policies in json format to the resource_id asociated.</p>
</li>
<li>
<p><strong>Get policy from id</strong>: Matches the policy by its unique ID</p>
</li>
<li>
<p><strong>Delete policy</strong>: Will recive a policy id and will find and delete the matched document</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This script is manipulated by the API which would intercept the request in order to perform PUT, POST and DELETE methods.<br>
In the future this will be complient with other databases in order to unify the methods mentioned above.</p>
</div>
</div>
<div class="sect3">
<h4 id="_software_reuse_and_dependencies_2">3.3.2. Software Reuse and Dependencies</h4>
<div class="paragraph">
<p>At the moment the usage is mainly for the policy interaction purposes, but this can easily be reused by other agents.</p>
</div>
</div>
<div class="sect3">
<h4 id="_data_flow_2">3.3.3. Data flow</h4>
<div class="paragraph">
<p>The database will only be accesible by the API or the Proxy.<br>
The main methods for the interaction with the database are displayed in this dataflow as a summary of its scope:</p>
</div>
</div>
<div class="sect3">
<h4 id="_applicable_resources_2">3.3.4. Applicable Resources</h4>
<div class="ulist">
<ul>
<li>
<p>MongoDB image from DockerHub - <a href="https://hub.docker.com/_/mongo" class="bare">https://hub.docker.com/_/mongo</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_logging">3.4. Logging</h3>
<div class="sect3">
<h4 id="_design">3.4.1. Design</h4>
<div class="paragraph">
<p>Logging accross the EOEPCA Building Blocks works much in the same way, by usage of a log helper class to initiate a Python logger, handler and formater that simultaneously outputs log messages to console and a log file. These log files are set on a rotation, with a 1GB limit per each, with the 10 latest log files being kept in memory.</p>
</div>
<div class="paragraph">
<p>A new configuration yaml file is added to the building block, containing initialization parameters.</p>
</div>
</div>
<div class="sect3">
<h4 id="_log_message_format">3.4.2. Log message format</h4>
<div class="paragraph">
<p>INFO level log messages follow the following format:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TIME: in ISO 8601 format, "%Y-%m-%dT%H:%M:%S%z"</p>
</li>
<li>
<p>LEVELNAME: INFO by default</p>
</li>
<li>
<p>COMPONENT: "PDP"</p>
</li>
<li>
<p>SUBCOMPONENT: N/A</p>
</li>
<li>
<p>ACTION IDENTIFIER: HTTP by default</p>
</li>
<li>
<p>ACTION TYPE:  HTTP method used</p>
</li>
<li>
<p>LOG CODE: Unique code identifying log message type</p>
</li>
<li>
<p>ACTIVITY: Detailed log message, check reference table</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_log_message_codes">3.4.3. Log message codes</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Log Codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Log Code</th>
<th class="tableblock halign-left valign-top">Structure</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"Description":"No token found"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"Description":"Error reading token","Token":token}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"Operation successful","Policy":policy_id}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"Invalid policy structure","Policy":policy}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"Invalid data structure","Policy":policy}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"User not found"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3007</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"500 Internal error"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3008</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"Policy List returned","Resource":resource_id,"PolicyList":policy_list}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3009</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"Policy returned","Policy":policy}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"204 Policy deleted"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"Invalid XACML format","Value":value}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3012</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"Attributes for user weren&#8217;t retrievable"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"No issuer emitted"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3014</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"User":user,"Description":"Validation completed","Decisions":decisions}</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="traceabilityMatrix">4. User Story Traceability</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. User Stories</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">User Story Code</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Building Block Use Case</th>
<th class="tableblock halign-left valign-top">Master Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-131</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allow for XACML-compliant responses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD Task</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-130</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authorization Server Connector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD Task</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-129</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Usage of XACML-compatible policy language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP-UC-001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local End-User Attribute Resolution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP-UC-003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-UC-0108</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-127</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Baseline XACML-based Requests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP-UC-001/PDP-UC-002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-125</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Management API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP-UC-006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD Task</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-143</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Ownership Enforcement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP-UC-001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-206</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create Swagger Endpoint for Policy Decision Endpoints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP-UC-006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD Task</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-29</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resorce Access without constraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-UC-0206/EOEPCA-UC-0207</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-28</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modify previously assigned access constraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP-UC-006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-27</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assign action-dependant access constraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-UC-0206/EOEPCA-UC-0207</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-26</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assign attribute-based access constraints with variable issuers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-UC-0206/EOEPCA-UC-0207</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-177</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delegated user authorization at 'other' PDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP-UC-005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-UC-0106/EOEPCA-UC-0107</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Definition and deployment of sample baseline policies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD Task</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-209</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation of Helm Charts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD Task</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOEPCA-222</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Administrative tooling for integration and operation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD Task</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph large">
<p>&lt;&lt; End of Document &gt;&gt;</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.2<br>
Last updated 2021-05-11 07:48:43 UTC
</div>
</div>
</body>
</html>